import{d as e,r as t,k as a,c as s,w as l,i as u,l as r,o,a as n,q as i,e as c,x as v,_}from"./index-BkZLuxpi.js";import{b as m}from"./index.ClAA1eWt.js";import"./remote-config.BGSfClRu.js";const d=_(e({__name:"training",setup(e){const _=t("IDLE"),d=t(!1),p=t(!1),y=t("red"),f=t([]),g=t(0);let k=0;const D=5,w=1e3,I=3e3;let h=0;const x=()=>{if(h>=D)return void N();d.value=!1,h++;const e=Math.random()*(I-w)+w;setTimeout(()=>{d.value=!0,y.value="green",k=Date.now(),f.value.push({timestamp:Date.now()-g.value,event_type:"stimulus_show",is_target:!0,is_correct:null,reaction_time:null}),setTimeout(()=>{d.value&&(d.value=!1,x())},2e3)},e)},E=()=>{const e=Date.now(),t=e-k;let a="";d.value?(d.value=!1,f.value.push({timestamp:e-g.value,event_type:"user_click",is_target:!0,reaction_time:t,is_correct:!0}),setTimeout(x,500)):(a="premature",f.value.push({timestamp:e-g.value,event_type:"user_click",is_target:!1,reaction_time:null,is_correct:!1,note:a}))},N=async()=>{_.value="FINISHED";const e={user_id:1,task_type:"delay_task_basic",difficulty_level:1,start_time:new Date(g.value).toISOString(),events:f.value};try{await m(e),console.log("数据上传成功")}catch(t){console.error("上传失败",t)}};return a(()=>{_.value="READY",g.value=Date.now(),h=0,f.value=[],setTimeout(()=>{_.value="PLAYING",x()},2e3)}),(e,t)=>{const a=r("NavigationBar"),m=u;return o(),s(m,{class:"container"},{default:l(()=>[n(a),n(m,{class:"game-wrapper"},{default:l(()=>["READY"===_.value?(o(),s(m,{key:0,class:"center-text"},{default:l(()=>[c(" 准备... ")]),_:1})):i("",!0),"PLAYING"===_.value?(o(),s(m,{key:1,class:"game-area",onTouchstart:E},{default:l(()=>[d.value?(o(),s(m,{key:0,class:"stimulus",style:v({backgroundColor:y.value})},null,8,["style"])):i("",!0),p.value?(o(),s(m,{key:1,class:"distractor"})):i("",!0)]),_:1})):i("",!0),"FINISHED"===_.value?(o(),s(m,{key:2,class:"center-text"},{default:l(()=>[c(" 完成！真棒！ ")]),_:1})):i("",!0)]),_:1})]),_:1})}}}),[["__scopeId","data-v-f225fa17"]]);export{d as default};
